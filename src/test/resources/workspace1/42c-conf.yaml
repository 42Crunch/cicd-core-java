audit:
  branches:
    master:
      # map filenames to IDs of already existing APIs
      #mapping:
      #  petstore-v3.yaml: 410c36d5-ca71-4b5e-a142-c12075a34d9c

      # find OpenAPI files in files with .json .yml .yaml extensions,
      # exclude node_modules/ directory from the search
      discovery:
        search:
          - '**/*.json'
          - '**/*.yaml'
          - '**/*.yml'
          - '!node_modules/**'

      # in addition to min score specified in the Azure Pipelines
      # check for the following issues
      fail_on:
        score: 75          

        # fail if OpenAPI file is not 'valid' OpenAPI as per audit report
        invalid_contract: true

        # fail any issues with severity of 'medium' or higher are detected.
        # possible severity levels: critical, high, medium, low, info
        severity: medium

        # fail if any of the listed issue IDs are detected
        issue_id:
          - v3-global-http-clear
          - v3-response-schema-undefined
